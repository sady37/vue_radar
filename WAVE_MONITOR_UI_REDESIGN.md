# WaveMonitor UI 重新设计

## 📊 设计对比

### 旧设计（复杂）

```
┌─────────────────────────────────────────────────────────────┐
│ Track                                                        │
│                                                              │
│ Device: [____▼]  StartTime: [__________]  TimeLong: [_] min│
│ ☐ EventTime [__________]                                    │
│                                                              │
│ [FromFile] [PlayBack] [Demo]                                │
└─────────────────────────────────────────────────────────────┘
```

**问题：**
- ❌ 两个时间输入框，容易混淆
- ❌ 复选框逻辑复杂（勾选后 StartTime 怎么办？）
- ❌ TimeLong 在 EventTime 时无意义
- ❌ 播放速度没有显示

---

### 新设计（简洁）

```
┌─────────────────────────────────────────────────────────────┐
│ Track                                                        │
│                                                              │
│ Device: [____▼]  Time: [__________]                         │
│                                                              │
│ ⦿ EventTime (前60秒, 后120秒)  ○ StartTime [2] min         │
│                                Speed: [1x ▼]                 │
│                                                              │
│ [FromFile] [PlayBack] [Demo]    Progress: 50/100           │
└─────────────────────────────────────────────────────────────┘
```

**优势：**
- ✅ 一个时间输入框（Time）
- ✅ 单选框清晰分离两种模式
- ✅ 每种模式的时长自动匹配
- ✅ 播放速度独立显示

---

## 🎯 核心改进

### 1. 统一时间输入

```
旧设计：
  StartTime: [__________]
  ☐ EventTime [__________]
  
  问题：两个输入框，用户不知道填哪个
  
新设计：
  Time: [__________]
  
  优势：只需输入一次，模式决定如何使用
```

---

### 2. 清晰的模式切换

```
旧设计：
  ☐ EventTime
  
  问题：
  - 复选框不明确（不勾选用什么模式？）
  - TimeLong 和 EventTime 冲突
  
新设计：
  ⦿ EventTime (前60秒, 后120秒)
  ○ StartTime [2] min
  
  优势：
  - 单选框明确二选一
  - 每种模式的行为一目了然
  - 自动显示/隐藏对应控件
```

---

### 3. 自动时长管理

```
旧设计：
  TimeLong: [2] min
  ☐ EventTime
  
  问题：勾选 EventTime 后，TimeLong 怎么办？
  
新设计：
  ⦿ EventTime → 自动3分钟（前60+后120）
  ○ StartTime → 手动输入 [__] min
  
  优势：
  - EventTime 无需手动输入时长
  - StartTime 时长输入自动显示
  - 互不干扰
```

---

### 4. 播放速度可见

```
旧设计：
  Speed: {{ playbackSpeed }}x
  
  问题：
  - 只在播放时显示
  - 无法在播放前调整
  
新设计：
  Speed: [1x ▼]
  
  优势：
  - 始终可见
  - 播放前可调整
  - 下拉框选择更直观
```

---

## 📐 布局结构

### 三行布局

```
第一行：设备 + 时间
┌─────────────────────────────────────────────────────────────┐
│ Track                                                        │
│ Device: [RADAR_001 ▼]  Time: [20251031 23:27:28]           │
└─────────────────────────────────────────────────────────────┘

第二行：模式 + 速度
┌─────────────────────────────────────────────────────────────┐
│ ⦿ EventTime (前60秒, 后120秒)  ○ StartTime [2] min         │
│                                Speed: [1x ▼]                 │
└─────────────────────────────────────────────────────────────┘

第三行：操作按钮 + 进度
┌─────────────────────────────────────────────────────────────┐
│ [FromFile] [PlayBack] [Demo]    Progress: 50/100           │
└─────────────────────────────────────────────────────────────┘
```

**设计原则：**
- 第一行：基础输入（设备、时间）
- 第二行：模式配置（EventTime/StartTime、速度）
- 第三行：操作执行（按钮、进度）

---

## 🎮 交互流程

### EventTime 模式

```
1. 输入 Time: 20251031 23:30:00
   ↓
2. 选择 ⦿ EventTime
   ↓
3. 自动显示 "(前60秒, 后120秒)"
   ↓
4. 选择 Speed: 1x
   ↓
5. 点击 PlayBack
   ↓
结果：
回放 23:29:00 ~ 23:32:00 (3分钟)
```

### StartTime 模式

```
1. 输入 Time: 20251031 23:00:00
   ↓
2. 选择 ⦿ StartTime
   ↓
3. 自动显示时长输入框 [2] min
   ↓
4. 修改时长为 5 min（可选）
   ↓
5. 选择 Speed: 1.5x
   ↓
6. 点击 PlayBack
   ↓
结果：
回放 23:00:00 ~ 23:05:00 (5分钟)
实际播放时长: 3.3分钟 (1.5倍速)
```

---

## 🎨 UI 细节

### 单选框样式

```html
<label class="radio-label">
  <input type="radio" v-model="timeMode" value="event" />
  <span>EventTime</span>
</label>
<span v-if="timeMode === 'event'" class="mode-info">
  (前60秒, 后120秒)
</span>
```

**效果：**
- ⦿ EventTime **(前60秒, 后120秒)** ← 选中时显示
- ○ StartTime [2] min

### 条件显示

```typescript
// EventTime 模式：显示说明文本
v-if="timeMode === 'event'"
  "(前60秒, 后120秒)"

// StartTime 模式：显示时长输入
v-if="timeMode === 'start'"
  <input type="number" v-model.number="timeLong" />
```

---

## 📊 数据流

```
用户输入
  ↓
timeInput: "20251031 23:30:00"
timeMode: "event" | "start"
timeLong: 2 (仅 StartTime 模式)
playbackSpeed: 1 | 1.5 | 2
  ↓
calculateTimeRange()
  ↓
EventTime 模式:
  {
    start: timestamp - 60,   // 前60秒
    event: timestamp,         // 事件时刻
    end: timestamp + 120,     // 后120秒
    duration: 180             // 固定3分钟
  }

StartTime 模式:
  {
    start: timestamp,
    end: timestamp + timeLong * 60,
    duration: timeLong * 60
  }
  ↓
播放回放（速度 × playbackSpeed）
```

---

## 🔄 状态管理

### 新状态定义

```typescript
const timeInput = ref('');  // 统一时间输入
const timeMode = ref<'event' | 'start'>('start');  // 模式
const timeLong = ref(2);  // StartTime 模式的时长
const playbackSpeed = ref<number>(1);  // 播放速度
```

**vs 旧状态：**

```typescript
// 旧
const startTime = ref('');      // ❌ 分离
const eventTime = ref('');      // ❌ 分离
const useEventTime = ref(false); // ❌ 复选框
const playbackSpeed = ref(1);    // ⚠️ 隐藏

// 新
const timeInput = ref('');       // ✅ 统一
const timeMode = ref('start');   // ✅ 单选
const timeLong = ref(2);         // ✅ 条件显示
const playbackSpeed = ref(1);    // ✅ 始终可见
```

---

## ✅ 改进总结

| 方面 | 旧设计 | 新设计 | 改进 |
|------|--------|--------|------|
| **时间输入** | 2个输入框 | 1个输入框 | ✅ 50% 减少 |
| **模式切换** | 复选框 | 单选框 | ✅ 更清晰 |
| **时长管理** | 总是显示 | 条件显示 | ✅ 更智能 |
| **播放速度** | 播放时显示 | 始终显示 | ✅ 可提前设置 |
| **布局层次** | 2行 | 3行 | ✅ 更有层次 |
| **用户操作** | 5步 | 3步 | ✅ 40% 减少 |

---

## 🎯 EventTime 时间分配详解

### 为什么是"前60秒 + 后120秒"？

```
事件时间轴：
├─ 前60秒 ─┤─ 事件 ─├───── 后120秒 ─────┤
23:29:00   23:30:00  23:30:00        23:32:00
   ↓          ↓         ↓               ↓
准备/征兆   事件发生  立即反应       后续影响

时长分配逻辑：
- 前60秒：观察事件发生前的活动和征兆
- 后120秒：观察事件后的反应和恢复情况
  (后续影响通常比准备阶段更重要)
```

**实际应用案例：**

```
跌倒事件：
  前60秒：老人走动、失去平衡
  事件：跌倒瞬间
  后120秒：躺地、尝试起身、救助

离床事件：
  前60秒：翻身、准备起床
  事件：离开床铺
  后120秒：站立、行走、活动范围
```

---

## 🚀 使用建议

### 何时用 EventTime？

```
✅ 适用场景：
  - 查看特定事件（跌倒、离床、入侵）
  - 分析事件前后因果关系
  - 快速定位异常时刻

✅ 优势：
  - 固定3分钟，快速
  - 自动对准事件中心
  - 符合 HIPAA 要求
```

### 何时用 StartTime？

```
✅ 适用场景：
  - 查看连续时间段
  - 观察长时间活动模式
  - 多个事件的完整过程

✅ 优势：
  - 时长可调（1-30分钟）
  - 灵活性高
  - 适合分析趋势
```

---

## 🎊 总结

### 核心设计理念

```
简洁 > 复杂
清晰 > 灵活
自动 > 手动
可见 > 隐藏
```

### 关键改进

1. **一个时间输入框** - 减少50%输入
2. **单选框模式** - 清晰二选一
3. **自动时长管理** - EventTime 固定，StartTime 可调
4. **速度始终可见** - 播放前可调整
5. **三行层次布局** - 输入→配置→执行

---

**全新 WaveMonitor，更简洁、更高效、更易用！** 🎉

