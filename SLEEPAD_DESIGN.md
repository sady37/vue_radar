# Sleepad 设备绘制设计

## 📋 设计规格

### 尺寸
```
长度：12px
宽度：6px
比例：2:1
```

### 组成元素
```
1. 矩形边框
   - 颜色：使用设备颜色（visual.color）
   - 线宽：1px
   - 填充：无（始终透明）

2. 3个绿色圆形指示器
   - 颜色：#00ff00（绿色）
   - 半径：1px
   - 位置：沿矩形中轴线平均分布
```

---

## 🎨 视觉效果

### 显示效果（只有边框）
```
  ┌─────────────┐
  │  ●   ●   ●  │  矩形12×6（无底色）
  └─────────────┘  3个绿色圆（半径1）
  
  ←─── 12px ───→
  
  圆的位置：
  左：-3px
  中：0px
  右：+3px
```

**特点**：
- 边框：紫色（#9C27B0）
- 填充：无（透明背景）
- 传感器：绿色圆点（始终显示）

---

## 📐 详细尺寸标注

### 矩形
```
中心点：(0, 0)
左上角：(-6, -3)
右上角：(+6, -3)
右下角：(+6, +3)
左下角：(-6, +3)
```

### 3个圆形位置
```
间距计算：length / 4 = 12 / 4 = 3px

左圆：(-3, 0)  半径1
中圆：(0, 0)   半径1
右圆：(+3, 0)  半径1

平均分布在矩形宽度上
```

---

## 🔧 代码实现

### 函数签名
```typescript
export function drawSleepAideDevice(
  ctx: CanvasRenderingContext2D,
  position: Point,
  visual: BaseObject['visual']
): void
```

### 绘制步骤
```typescript
1. 移动到设备位置
   ctx.translate(position.x, position.y);

2. 绘制矩形边框（只有边框，无底色）
   ctx.rect(-6, -3, 12, 6);
   ctx.strokeStyle = visual.color;
   ctx.lineWidth = 1;
   ctx.stroke(); // 只绘制边框

3. 绘制3个绿色圆
   ctx.fillStyle = '#00ff00';
   
   // 左圆
   ctx.arc(-3, 0, 1, 0, Math.PI * 2);
   ctx.fill();
   
   // 中圆
   ctx.arc(0, 0, 1, 0, Math.PI * 2);
   ctx.fill();
   
   // 右圆
   ctx.arc(3, 0, 1, 0, Math.PI * 2);
   ctx.fill();
```

---

## 💡 设计理由

### 为什么用矩形？
- **形状直观**：睡眠垫通常是长方形
- **方向明确**：长宽比2:1，容易识别方向
- **空间紧凑**：12×6的尺寸适合Canvas显示

### 为什么只有边框无底色？
- **视觉简洁**：不遮挡床的颜色和轮廓
- **层次清晰**：边框标识范围，圆点标识传感器
- **实际对应**：Sleepad放在床垫下，实际看不到底色
- **突出重点**：让绿色传感器圆点更醒目
- **避免混淆**：不与家具颜色重叠

### 为什么用3个绿色圆？
- **传感器标识**：3个圆代表3个传感器点
- **均匀分布**：代表监测区域的均匀覆盖
- **绿色含义**：
  - 工作状态指示
  - 与其他设备LED指示器统一
  - 醒目且不突兀

### 为什么平均分布？
- **对称美观**：视觉平衡
- **实际对应**：睡眠垫通常在头、胸、腿部位置有传感器
- **清晰易识**：间距相等，一目了然

---

## 🎯 使用场景

### 设备用途
```
Sleepad（睡眠垫）：
- 放置在床垫下
- 监测睡眠体征
- 非接触式传感
- 3个传感器点位
```

### 在Canvas中的显示
```
- 尺寸小巧：12×6px
- 方向可旋转：通过上层rotation处理
- 颜色可配置：默认紫色 #9C27B0
- 支持透明模式：只显示边框
```

---

## 📊 与其他设备对比

| 设备 | 形状 | 尺寸 | 指示器 |
|------|------|------|--------|
| **Radar** | 圆形/扇形 | 半径15px | 绿色LED矩形 |
| **Sleepad** | 矩形 | 12×6px | 3个绿色圆 |
| **Sensor** | 菱形 | 边长12px | 中心字符 |
| **Generic** | 方形 | 30×30px | 文字标签 |

---

## 🎨 颜色配置

### 默认颜色（参考预设）
```typescript
// src/config/presets.ts
SleepAide: {
  defaultPosition: { x: 0, y: 100, z: 100 },
  color: '#9C27B0',  // 紫色
  setupModel: 'ceiling',
  description: '睡眠辅助监测器'
}
```

### 视觉效果
```
显示效果（始终无底色）：
┌─────────────┐ 
│  ●   ●   ●  │  紫色边框（无填充）
└─────────────┘  绿色圆点

特点：
- 边框：紫色 #9C27B0
- 填充：无（透明）
- 圆点：绿色 #00ff00
```

---

## 🔄 旋转效果

### 横向（默认，angle = 0°）
```
  ┌─────────────┐
  │  ●   ●   ●  │
  └─────────────┘
```

### 纵向（angle = 90°）
```
    ┌───┐
    │ ● │
    │ ● │
    │ ● │
    └───┘
```

**注意**：旋转由上层（drawObjects.ts）处理，绘制函数只负责绘制默认方向。

---

## 📏 精确坐标

### 矩形顶点（相对坐标）
```
v1: (-6, -3)  左上
v2: (+6, -3)  右上
v3: (+6, +3)  右下
v4: (-6, +3)  左下
```

### 圆心坐标（相对坐标）
```
circle1: (-3, 0)
circle2: (0, 0)
circle3: (+3, 0)

均在Y=0的中轴线上
X轴间距：3px（length/4）
```

---

## ✅ 实现要点

1. **使用相对坐标**
   - 以(0,0)为中心绘制
   - 通过translate移动到实际位置

2. **只绘制边框**
   - 不调用fill()，只调用stroke()
   - strokeStyle使用设备颜色
   - lineWidth = 1px

3. **固定圆形颜色**
   - 3个圆始终为绿色#00ff00
   - 不受设备颜色影响

4. **精确分布**
   - spacing = length / 4 = 3px
   - 确保3个圆均匀分布

5. **图层管理**
   - IoT设备始终在最上层
   - 不会被家具遮挡

---

## 🔍 代码位置

**文件**：`src/utils/drawDevices.ts`

**函数**：`drawSleepAideDevice()`

**行数**：约238-282行

---

## 📚 相关文档

- `RADAR_DESIGN_FINAL.md` - 雷达设备设计
- `COLOR_PRESETS.md` - 设备颜色预设
- `RADAR_DRAWING_UPDATED.md` - 旋转处理说明

---

**版本**：v1.1  
**日期**：2025-10-29  
**状态**：✅ 已实现  
**更新**：只显示边框，无底色；IoT设备图层管理

