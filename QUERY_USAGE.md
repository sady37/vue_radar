# ğŸ” å†å²æ•°æ®æŸ¥è¯¢ä½¿ç”¨æŒ‡å—

## ğŸ¯ åŠŸèƒ½è¯´æ˜

é€šè¿‡è¾“å…¥æˆ¿é—´/åºŠä½/æ—¶é—´ï¼Œè‡ªåŠ¨æŸ¥è¯¢æ•°æ®åº“è·å–å¯¹åº”çš„é›·è¾¾è®¾å¤‡å’Œå¸ƒå±€é…ç½®ï¼Œç„¶åæ’­æ”¾å†å²æ•°æ®ã€‚

---

## ğŸ“± ä½¿ç”¨æ–¹å¼

### æ–¹å¼1ï¼šç½‘é¡µç«¯æ‰‹åŠ¨æŸ¥è¯¢ â­ æ¨è

1. **æ‰“å¼€ç³»ç»Ÿ**
   ```
   http://localhost:5173/
   ```

2. **ç‚¹å‡»æŸ¥è¯¢æŒ‰é’®**
   - å³ä¸Šè§’è“è‰²ğŸ”æŒ‰é’®

3. **å¡«å†™æŸ¥è¯¢è¡¨å•**
   ```
   æˆ¿é—´å·ï¼š101
   åºŠä½å·ï¼š1
   å¼€å§‹æ—¶é—´ï¼š2024-11-01 08:00
   ç»“æŸæ—¶é—´ï¼š2024-11-01 10:00
   ```

4. **ç‚¹å‡»æŸ¥è¯¢**
   - ç³»ç»Ÿè‡ªåŠ¨æŸ¥è¯¢é…ç½®
   - è‡ªåŠ¨åŠ è½½å¸ƒå±€
   - è‡ªåŠ¨æ’­æ”¾å†å²æ•°æ®

---

### æ–¹å¼2ï¼šURLå‚æ•°ç›´æ¥è®¿é—®ï¼ˆå¤–éƒ¨ç³»ç»Ÿé›†æˆï¼‰

**URLæ ¼å¼ï¼š**
```
http://localhost:5173/?mode=query&roomId=101&bedId=1&start=1699000000000&end=1699003600000
```

**å‚æ•°è¯´æ˜ï¼š**
- `mode=query` - æŸ¥è¯¢æ¨¡å¼
- `roomId` - æˆ¿é—´ID
- `bedId` - åºŠä½ID
- `start` - å¼€å§‹æ—¶é—´æˆ³ï¼ˆæ¯«ç§’ï¼‰
- `end` - ç»“æŸæ—¶é—´æˆ³ï¼ˆæ¯«ç§’ï¼‰

**ç¤ºä¾‹ï¼š**
```javascript
// å¤–éƒ¨ç³»ç»Ÿç”ŸæˆURL
const roomId = '101';
const bedId = '1';
const startTime = new Date('2024-11-01 08:00').getTime();
const endTime = new Date('2024-11-01 10:00').getTime();

const url = `http://localhost:5173/?mode=query&roomId=${roomId}&bedId=${bedId}&start=${startTime}&end=${endTime}`;

// æ‰“å¼€æ–°çª—å£
window.open(url, '_blank');
```

---

## ğŸ—ï¸ æ¶æ„è¯´æ˜

### ç»„ä»¶ç»“æ„

```
App.vue
â”œâ”€ QueryPanel.vue         æŸ¥è¯¢é¢æ¿ï¼ˆå¼¹çª—ï¼‰
â”œâ”€ RadarCanvas.vue        é›·è¾¾ç”»å¸ƒ
â”œâ”€ WaveMonitor.vue        æ³¢å½¢ç›‘æµ‹ï¼ˆfromserveræ¨¡å¼ï¼‰
â””â”€ Toolbar.vue            å·¥å…·æ 
```

### æ•°æ®æµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ç”¨æˆ·è¾“å…¥     â”‚
â”‚ æˆ¿é—´/åºŠä½/æ—¶é—´â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ QueryPanel   â”‚ â† ç‚¹å‡»æŸ¥è¯¢æŒ‰é’®
â”‚ è¡¨å•éªŒè¯     â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ APIè°ƒç”¨              â”‚
â”‚ POST /api/query-radar-config â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ•°æ®åº“æŸ¥è¯¢   â”‚
â”‚ bed_radar_   â”‚
â”‚ binding      â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ è¿”å›é…ç½®     â”‚
â”‚ {radarId,    â”‚
â”‚  layout,...} â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ canvasStore  â”‚
â”‚ setParams()  â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ radarDataStoreâ”‚
â”‚ setMode()    â”‚
â”‚ 'fromserver' â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ WaveMonitor  â”‚
â”‚ æ’­æ”¾å†å²æ•°æ® â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“‹ APIæ¥å£æ–‡æ¡£

### æŸ¥è¯¢é›·è¾¾é…ç½®

**æ¥å£ï¼š** `POST /api/query-radar-config`

**è¯·æ±‚ä½“ï¼š**
```json
{
  "roomId": "101",
  "bedId": "1",
  "startTime": 1699000000000,
  "endTime": 1699003600000
}
```

**å“åº”ï¼š**
```json
{
  "success": true,
  "data": {
    "radarId": "RADAR_001",
    "deviceCode": "RD001",
    "deviceName": "101-1",
    "layout": {
      "radar": {
        "position": { "x": 300, "y": 100 },
        "rotation": 0,
        "config": {
          "horizontalAngle": 120,
          "verticalAngle": 60,
          "maxDistance": 300
        }
      },
      "furniture": [
        {
          "type": "bed",
          "position": { "x": 300, "y": 200 },
          "rotation": 0,
          "width": 200,
          "height": 100
        }
      ]
    },
    "timeRange": {
      "start": 1699000000000,
      "end": 1699003600000
    }
  }
}
```

---

## ğŸ—ƒï¸ æ•°æ®åº“é…ç½®

### è¡¨ç»“æ„

```sql
CREATE TABLE bed_radar_binding (
  id INT PRIMARY KEY AUTO_INCREMENT,
  room_id VARCHAR(50) NOT NULL,
  bed_id VARCHAR(50) NOT NULL,
  radar_id VARCHAR(100) NOT NULL,
  device_code VARCHAR(100) NOT NULL,
  bind_time BIGINT NOT NULL,
  unbind_time BIGINT,
  layout_config TEXT NOT NULL,
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  INDEX idx_room_bed (room_id, bed_id),
  INDEX idx_time (bind_time, unbind_time)
);
```

### ç¤ºä¾‹æ•°æ®

```sql
INSERT INTO bed_radar_binding 
(room_id, bed_id, radar_id, device_code, bind_time, layout_config)
VALUES 
('101', '1', 'RADAR_001', 'RD001', 1699000000000, '{
  "radar": {
    "position": {"x": 300, "y": 100},
    "rotation": 0,
    "config": {
      "horizontalAngle": 120,
      "verticalAngle": 60,
      "maxDistance": 300
    }
  },
  "furniture": [
    {
      "type": "bed",
      "position": {"x": 300, "y": 200},
      "rotation": 0,
      "width": 200,
      "height": 100
    }
  ]
}');
```

---

## ğŸ¨ ç•Œé¢è¯´æ˜

### æŸ¥è¯¢æŒ‰é’®

- **ä½ç½®**ï¼šå³ä¸Šè§’æ‚¬æµ®æŒ‰é’®
- **å›¾æ ‡**ï¼šğŸ”
- **é¢œè‰²**ï¼šè“è‰²åœ†å½¢æŒ‰é’®
- **åŠŸèƒ½**ï¼šç‚¹å‡»æ‰“å¼€æŸ¥è¯¢é¢æ¿

### æŸ¥è¯¢é¢æ¿

- **æ ·å¼**ï¼šå±…ä¸­å¼¹çª—
- **å­—æ®µ**ï¼š
  - æˆ¿é—´å·ï¼ˆæ–‡æœ¬è¾“å…¥ï¼‰
  - åºŠä½å·ï¼ˆæ–‡æœ¬è¾“å…¥ï¼‰
  - å¼€å§‹æ—¶é—´ï¼ˆæ—¥æœŸæ—¶é—´é€‰æ‹©å™¨ï¼‰
  - ç»“æŸæ—¶é—´ï¼ˆæ—¥æœŸæ—¶é—´é€‰æ‹©å™¨ï¼‰
- **æŒ‰é’®**ï¼š
  - æŸ¥è¯¢ï¼ˆè“è‰²ï¼Œä¸»æŒ‰é’®ï¼‰
  - å–æ¶ˆï¼ˆç°è‰²ï¼Œæ¬¡æŒ‰é’®ï¼‰

---

## ğŸ”§ é…ç½®è¯´æ˜

### å‰ç«¯é…ç½®

**æ–‡ä»¶ï¼š** `src/components/QueryPanel.vue`

```typescript
// APIåœ°å€é…ç½®
const API_URL = '/api/query-radar-config';

// å¯æ ¹æ®ç¯å¢ƒä¿®æ”¹
const API_URL = process.env.VUE_APP_API_URL || '/api/query-radar-config';
```

### åç«¯é…ç½®

**æ–‡ä»¶ï¼š** `backend/config.js`

```javascript
module.exports = {
  database: {
    host: 'localhost',
    port: 3306,
    user: 'root',
    password: 'password',
    database: 'radar_system'
  },
  api: {
    port: 3000,
    prefix: '/api'
  }
};
```

---

## âœ… æµ‹è¯•æ­¥éª¤

### 1. å‡†å¤‡æµ‹è¯•æ•°æ®

```sql
-- æ’å…¥æµ‹è¯•ç»‘å®šæ•°æ®
INSERT INTO bed_radar_binding VALUES
(1, '101', '1', 'RADAR_001', 'RD001', 1699000000000, NULL, '{...}', NOW());
```

### 2. å¯åŠ¨åç«¯æœåŠ¡

```bash
cd backend
npm install
npm start
```

### 3. å¯åŠ¨å‰ç«¯æœåŠ¡

```bash
cd vue_radar
npm install
npm run dev
```

### 4. æµ‹è¯•æŸ¥è¯¢åŠŸèƒ½

**æ–¹å¼1ï¼šç½‘é¡µæŸ¥è¯¢**
1. æ‰“å¼€ http://localhost:5173/
2. ç‚¹å‡»å³ä¸Šè§’ğŸ”æŒ‰é’®
3. å¡«å†™ï¼šæˆ¿é—´å·=101, åºŠä½å·=1
4. é€‰æ‹©æ—¶é—´èŒƒå›´
5. ç‚¹å‡»æŸ¥è¯¢

**æ–¹å¼2ï¼šURLè®¿é—®**
```
http://localhost:5173/?mode=query&roomId=101&bedId=1&start=1699000000000&end=1699003600000
```

---

## ğŸ› å¸¸è§é—®é¢˜

### Q: æŸ¥è¯¢å¤±è´¥æ€ä¹ˆåŠï¼Ÿ

**A:** æ£€æŸ¥ä»¥ä¸‹å‡ ç‚¹ï¼š
1. åç«¯APIæ˜¯å¦æ­£å¸¸è¿è¡Œ
2. æ•°æ®åº“è¿æ¥æ˜¯å¦æ­£å¸¸
3. æ˜¯å¦å­˜åœ¨å¯¹åº”çš„ç»‘å®šè®°å½•
4. æ—¶é—´èŒƒå›´æ˜¯å¦æ­£ç¡®

### Q: æŸ¥è¯¢åˆ°é…ç½®ä½†ä¸æ’­æ”¾ï¼Ÿ

**A:** æ£€æŸ¥ï¼š
1. WaveMonitoræ˜¯å¦åˆ‡æ¢åˆ°fromserveræ¨¡å¼
2. æ—¶é—´èŒƒå›´å†…æ˜¯å¦æœ‰å†å²æ•°æ®
3. æµè§ˆå™¨æ§åˆ¶å°æ˜¯å¦æœ‰é”™è¯¯

### Q: å¦‚ä½•è°ƒè¯•APIè°ƒç”¨ï¼Ÿ

**A:** æ‰“å¼€æµè§ˆå™¨æ§åˆ¶å°ï¼ˆF12ï¼‰â†’ Networkæ ‡ç­¾ â†’ æŸ¥çœ‹APIè¯·æ±‚å’Œå“åº”

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [APIé›†æˆæ–‡æ¡£](./API_INTEGRATION.md)
- [æ•°æ®åº“è®¾è®¡](./database/README.md)
- [WaveMonitoræ–‡æ¡£](./src/components/WAVE_MONITOR_GUIDE.md)

---

## ğŸ‰ æ€»ç»“

- âœ… **ç®€å•æ˜“ç”¨**ï¼šè¾“å…¥æˆ¿é—´/åºŠä½/æ—¶é—´å³å¯æŸ¥è¯¢
- âœ… **çµæ´»é›†æˆ**ï¼šæ”¯æŒç½‘é¡µæŸ¥è¯¢å’ŒURLå‚æ•°ä¸¤ç§æ–¹å¼
- âœ… **è‡ªåŠ¨æ’­æ”¾**ï¼šæŸ¥è¯¢åè‡ªåŠ¨åŠ è½½é…ç½®å¹¶æ’­æ”¾å†å²æ•°æ®
- âœ… **å¤–éƒ¨è°ƒç”¨**ï¼šHISç­‰å¤–éƒ¨ç³»ç»Ÿå¯é€šè¿‡URLç›´æ¥æ‰“å¼€

**ç°åœ¨ç”¨æˆ·å¯ä»¥è½»æ¾æŸ¥è¯¢å’Œæ’­æ”¾ä»»æ„æ—¶é—´æ®µçš„å†å²æ•°æ®äº†ï¼** ğŸš€

